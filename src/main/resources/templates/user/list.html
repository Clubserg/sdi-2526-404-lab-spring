<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.w3.org/1999/xhtml">
<head th:replace="fragments/head"><title>Listado de Usuarios</title></head>
<body>

<nav th:replace="fragments/nav"></nav>

<div class="container" id="main-container">
    <h2>Usuarios</h2>

    <form class="form-inline" action="/user/list">
        <div class="form-group">
            <input name="searchText" type="text" class="form-control" size="50"
                   placeholder="Buscar por nombre, apellidos o DNI">
        </div>
        <button type="submit" class="btn btn-primary">Buscar</button>
    </form>

    <p>Los usuarios que actualmente figuran en el sistema son los siguientes:</p>

    <button type="button" id="updateButton" class="btn btn-primary">Actualizar</button>

    <script th:inline="javascript">
        /*<![CDATA[*/
        $("#updateButton").click(function () {
            // Obtenemos la página actual de los parámetros de la URL si existe
            let page = /*[[${param.page != null and !#lists.isEmpty(param.page) ? param.page[0] : null}]]*/ null;
            let urlUpdate = '/user/list/update';
            if (page != null) {
                urlUpdate += "?page=" + page;
            }
            // Recargamos solo la tabla de usuarios
            $("#usersTable").load(urlUpdate);
        });
        /*]]>*/
    </script>

    <div class="table-responsive">
        <div th:replace="fragments/userList"></div>
    </div>

</div>

<footer th:replace="fragments/footer"></footer>

</body>
</html>